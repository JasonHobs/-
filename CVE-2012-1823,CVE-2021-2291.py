import requests
from requests.auth import HTTPBasicAuth

# Funkcia na kontrolu CVE-2012-1823 (PHP CGI Argument Injection)
def check_cve_2012_1823(url, username, password):
    headers = {
        "Range": "bytes=0-1000"  # Testujeme rozsah, ktorý je často indikátorom zraniteľnosti
    }
    try:
        response = requests.get(url, headers=headers, auth=HTTPBasicAuth(username, password))
        
        # Ak je odpoveď 206, znamená to, že server môže byť zraniteľný
        if response.status_code == 206:
            print("[+] CVE-2012-1823: Server is vulnerable!")
        else:
            print("[-] CVE-2012-1823: Server is not vulnerable")
    except requests.exceptions.RequestException as e:
        print(f"Error: {e}")

# Funkcia na kontrolu CVE-2021-2291 (X-Powered-By)
def check_cve_2021_2291(url, username, password):
    try:
        response = requests.get(url, auth=HTTPBasicAuth(username, password))
        
        # Kontrola hlavičky X-Powered-By, ktorá môže indikovať zraniteľnosť
        if "X-Powered-By" in response.headers:
            print("[+] CVE-2021-2291: Server is vulnerable!")
        else:
            print("[-] CVE-2021-2291: Server is not vulnerable")
    except requests.exceptions.RequestException as e:
        print(f"Error: {e}")

# Príklad testu na iné zraniteľnosti
def check_other_exploits(url, username, password):
    # Pridajte tu ďalšie CVE alebo testy podľa potreby
    print("[*] Additional tests can be added for more CVEs")

# Hlavná funkcia na testovanie zraniteľností
def check_vulnerabilities(url, username, password):
    # Uistíme sa, že URL začína s https:// alebo http://
    url = url.strip()  # Odstránenie medzier okolo URL
    if not url.startswith("http://") and not url.startswith("https://"):
        print("Error: Invalid URL. Please include the scheme (e.g., https://).")
        return
    
    print(f"Checking vulnerabilities for {url} with username {username} and password {password}")
    
    # Skontrolovať CVE-2012-1823
    check_cve_2012_1823(url, username, password)
    
    # Skontrolovať CVE-2021-2291
    check_cve_2021_2291(url, username, password)
    
    # Ďalšie testy zraniteľností
    check_other_exploits(url, username, password)

# Používateľské vstupy
if __name__ == "__main__":
    target_url = input("Enter the URL (e.g., https://example.com): ").strip()
    username = input("Enter the username: ").strip()
    password = input("Enter the password: ").strip()
    
    # Spustiť kontrolu zraniteľností
    check_vulnerabilities(target_url, username, password)
